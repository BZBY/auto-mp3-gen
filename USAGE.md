# 📖 使用说明

## 🚀 快速开始

### 方法一：一键启动（推荐）
```bash
python start.py
```

### 方法二：使用启动脚本
```bash
# Windows
start.bat

# Linux/macOS
./start.sh
```

### 方法三：手动启动
```bash
# 同时启动前后端
yarn dev

# 或分别启动
yarn server  # 启动后端
yarn client  # 启动前端
```

## 📋 使用步骤

### 1. 准备文件
- **视频文件**: 支持 MP4, AVI, MKV, MOV, WMV, FLV, M4V
- **字幕文件**: 支持 SRT, ASS, SSA, VTT
- 确保视频和字幕时间轴同步

### 2. 访问系统
打开浏览器访问: http://localhost:3000

### 3. 上传文件
1. 拖拽或点击上传视频文件
2. 拖拽或点击上传字幕文件
3. 配置处理参数（可选）：
   - 说话人数量：预期的角色数量
   - UVR5路径：人声分离软件路径

### 4. 开始处理
点击"开始处理"按钮，系统会自动：
- 提取音轨
- 解析字幕
- 切分音频
- 人声分离
- 说话人识别
- 生成结果

### 5. 查看结果
- 查看每个说话人的统计信息
- 预览对话内容
- 下载音频和字幕文件

## ⚙️ 高级配置

### UVR5人声分离
为获得最佳效果，建议安装 Ultimate Vocal Remover 5：

1. 下载安装UVR5：https://github.com/Anjok07/ultimatevocalremovergui
2. 在上传界面配置UVR5路径
3. 常见安装路径：
   - Windows: `C:/Program Files/Ultimate Vocal Remover`
   - 自定义安装：根据实际路径填写

### 说话人数量设置
- 留空：系统自动检测（推荐）
- 手动设置：2-10个说话人
- 建议根据动漫实际角色数量设置

## 📁 输出文件说明

### 文件结构
```
output/
├── speaker_00/           # 说话人0
│   ├── speaker_00_001.wav  # 音频文件
│   ├── speaker_00_001.txt  # 对应字幕
│   └── ...
├── speaker_01/           # 说话人1
│   └── ...
├── export_info.json      # 详细导出信息
└── summary.txt          # 处理摘要
```

### 文件命名规则
- 音频：`speaker_{ID}_{序号}.wav`
- 字幕：`speaker_{ID}_{序号}.txt`
- ID从00开始递增
- 序号按时间顺序排列

## 🔧 故障排除

### 常见问题

#### 1. 上传失败
- 检查文件大小（视频<2GB，字幕<10MB）
- 确认文件格式支持
- 检查网络连接

#### 2. 处理失败
- 查看错误信息
- 检查磁盘空间（建议>2GB）
- 确认FFmpeg已安装
- 验证视频和字幕文件完整性

#### 3. 人声分离效果差
- 安装并配置UVR5
- 检查UVR5路径是否正确
- 尝试不同的UVR5模型

#### 4. 说话人识别不准确
- 调整说话人数量设置
- 确保音频质量良好
- 检查字幕时间轴准确性

### 性能优化

#### 处理速度慢
- 使用较短的测试片段验证
- 确保足够的内存和CPU资源
- 关闭其他占用资源的程序

#### 内存不足
- 处理较短的视频片段
- 降低音频采样率设置
- 增加系统虚拟内存

## 📊 系统要求

### 最低要求
- Python 3.8+
- Node.js 16+
- 2GB 可用磁盘空间
- 4GB 内存

### 推荐配置
- Python 3.9+
- Node.js 18+
- 10GB 可用磁盘空间
- 8GB 内存
- 安装 FFmpeg
- 安装 UVR5

## 🎯 使用技巧

### 获得最佳效果
1. **字幕质量**：使用准确的时间轴和完整的对话内容
2. **视频质量**：选择音频清晰、背景音较少的片段
3. **说话人设置**：根据实际角色数量合理设置
4. **测试优先**：先用短片段测试效果再处理完整视频

### 批量处理
1. 准备多个视频和对应字幕
2. 逐个处理，避免同时处理多个文件
3. 及时保存和备份结果

### 结果优化
1. 检查每个说话人的对话内容
2. 手动调整明显错误的分类
3. 合并相似的说话人（如需要）

## 📞 技术支持

### 日志查看
- 后端日志：控制台输出
- 前端日志：浏览器开发者工具
- 系统日志：检查系统事件

### 问题反馈
提供以下信息有助于问题诊断：
- 操作系统版本
- Python和Node.js版本
- 错误信息截图
- 视频和字幕文件信息
- 处理配置参数

---

**享受从动漫中提取角色对话的乐趣！** 🎬✨
